import{a as m}from"./chunk-GW7PBGRF.js";import{E as c,H as u,I as p,L as l,f as n,h as s,j as a,t as o}from"./chunk-XSD7VU42.js";var h=class t{constructor(e){this.apiService=e}userPermissions=[];permissions=["ROLE_MARKETING","ROLE_USER"];evento=new n;evento$=this.evento.asObservable();emitirEvento(e){this.evento.next(e)}getAuthorization(){return this.apiService.httpGet("/user/public/status",!0,!1).pipe(a(e=>e.message_status?(this.userPermissions=e.permissions,!0):!1),o(e=>(console.error("Error en getAuthorization:",e),s(!1))))}loginFunction(e,r){let v=JSON.stringify({username:e,password:r});return this.apiService.httpPost("/user/public/auth/login",v,!0,!1,"application/json").pipe(u(i=>{this.userPermissions=i.permissions??""}),c(()=>this.getAuthorization()),o(i=>(console.error("Error en loginFunction o getAuthorization (dentro de switchMap):",i),s(!1))))}logout(){this.apiService.httpPost("/user/public/auth/logout",{}).subscribe(e=>{(e.status=200)&&console.log("Se ha cerrado sesi\xF3n correctamente")})}checkPermissions(e){return!!this.userPermissions.includes(e)}removePermissions(){this.userPermissions=[]}static \u0275fac=function(r){return new(r||t)(l(m))};static \u0275prov=p({token:t,factory:t.\u0275fac,providedIn:"root"})};export{h as a};
